<!DOCTYPE html>
<html lang="or">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMS Ultimate - Samsung A14 Version</title>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>
    
    <style>
        :root { --primary: #1e40af; --bg: #ffffff; --text: #1e293b; --success: #10b981; }
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background: #ffffff; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }

        /* Login Screen */
        #login-overlay { position: fixed; inset: 0; background: white; display: flex; align-items: center; justify-content: center; z-index: 10000; }
        .login-box { width: 85%; max-width: 380px; text-align: center; }
        .login-box input { width: 100%; padding: 15px; margin: 10px 0; border-radius: 12px; border: 2px solid #e2e8f0; font-size: 16px; box-sizing: border-box; }
        .login-box button { width: 100%; padding: 15px; background: var(--primary); color: white; border: none; border-radius: 12px; font-weight: bold; font-size: 18px; }

        /* Top Navigation */
        .nav-header { background: white; padding: 10px; display: flex; overflow-x: auto; gap: 8px; border-bottom: 2px solid #f1f5f9; position: sticky; top: 0; z-index: 100; }
        .nav-btn { white-space: nowrap; padding: 12px 20px; border-radius: 30px; border: 1px solid #e2e8f0; background: #f8fafc; font-weight: 600; font-size: 14px; color: #475569; }
        .nav-btn.active { background: var(--primary); color: white; border-color: var(--primary); }

        /* Folder Tabs for Notebook */
        .folder-nav { display: flex; gap: 5px; padding: 10px; background: #f8fafc; border-bottom: 1px solid #e2e8f0; overflow-x: auto; }
        .f-tab { padding: 10px 15px; border-radius: 8px; border: 1px solid #cbd5e1; background: white; font-size: 13px; font-weight: bold; white-space: nowrap; }
        .f-tab.active { background: #38bdf8; color: white; border-color: #38bdf8; }

        /* Content Area */
        .workspace { flex-grow: 1; overflow-y: auto; padding: 15px; }
        .page { display: none; width: 100%; }
        .page.active { display: block; }

        /* Notebook Styles */
        .notebook { width: 100%; min-height: 1000px; padding: 25px; outline: none; font-size: 20px; line-height: 1.6; color: #334155; box-sizing: border-box; border: 1px solid #eee; border-radius: 8px; }

        /* Sketch Pad (Circuit Design) */
        #sketch-container { border: 2px dashed #cbd5e1; margin-top: 20px; border-radius: 12px; background: #fdfdfd; }
        canvas { touch-action: none; width: 100%; height: 400px; display: block; cursor: crosshair; }
        .sketch-tools { display: flex; justify-content: space-between; padding: 10px; background: #f1f5f9; border-top: 1px solid #cbd5e1; border-radius: 0 0 12px 12px; }

        /* Tool Cards */
        .card { background: white; padding: 25px; border-radius: 15px; border: 1px solid #e2e8f0; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.02); }
        .calc-input { width: 100%; padding: 15px; margin: 10px 0; border: 1px solid #cbd5e1; border-radius: 10px; font-size: 18px; box-sizing: border-box; }
        
        .save-btn { position: fixed; bottom: 25px; right: 25px; background: var(--success); color: white; border: none; padding: 20px 30px; border-radius: 50px; font-weight: bold; font-size: 16px; box-shadow: 0 10px 20px rgba(0,0,0,0.2); z-index: 500; }
        .res-box { background: #f0fdf4; padding: 15px; border-radius: 10px; color: #166534; font-weight: bold; margin-top: 10px; border: 1px solid #bbf7d0; }
    </style>
</head>
<body>

<div id="login-overlay">
    <div class="login-box">
        <h2 style="color: var(--primary);">AMS MASTER WORKSTATION</h2>
        <input type="email" id="email" placeholder="Email (Abdurhamanmohammeda@gmail.com)">
        <input type="password" id="password" placeholder="Password (Abdu@1234)">
        <button onclick="checkLogin()">UNLOCK SYSTEM</button>
        <p id="error" style="color: red; margin-top: 15px; font-size: 14px;"></p>
    </div>
</div>

<div id="app-content" style="display:none; flex-direction: column; height: 100vh;">
    <div class="nav-header">
        <button class="nav-btn active" id="b1" onclick="showP('p1','b1')">üìÅ Digital Folders</button>
        <button class="nav-btn" id="b2" onclick="showP('p2','b2')">‚ö° Electrical Tool</button>
        <button class="nav-btn" id="b3" onclick="showP('p3','b3')">üèó Construction</button>
        <button class="nav-btn" id="b4" onclick="showP('p4','b4')">üìü Multimeter</button>
        <button onclick="logout()" style="border:none; background:none; color:red; font-weight:bold;">Exit</button>
    </div>

    <div class="workspace">
        <div id="p1" class="page active">
            <div class="folder-nav">
                <button class="f-tab active" id="f-mech" onclick="switchFolder('Mechatronics', 'f-mech')">‚öôÔ∏è Mechatronics</button>
                <button class="f-tab" id="f-const" onclick="switchFolder('Construction', 'f-const')">üèóÔ∏è Construction</button>
                <button class="f-tab" id="f-daily" onclick="switchFolder('DailyLogs', 'f-daily')">üìÖ Daily Logs</button>
            </div>
            
            <div id="nb-area" class="notebook" contenteditable="true">
                <h3 id="folder-title">Mechatronics Notebook</h3>
                <hr>
                <p>Jalqaba asirratti barreeffama kee galchi...</p>
            </div>

            <div id="sketch-container">
                <h4 style="margin: 10px; color: var(--primary);">üìê Circuit Design Sketch Pad</h4>
                
                <canvas id="circuitCanvas"></canvas>
                <div class="sketch-tools">
                    <button onclick="clearCanvas()" style="background:#fee2e2; color:#b91c1c; border:1px solid #fecaca; padding:10px 20px; border-radius:10px; font-weight:bold;">Haqi (Clear)</button>
                    <span style="font-size: 12px; color: #64748b;">Quba keetiin asitti kaasi</span>
                </div>
            </div>
        </div>

        <div id="p2" class="page">
            <div class="card">
                <h3>Ohm's Law Calculator</h3>
                [attachment_0](attachment)
                V: <input type="number" id="v" oninput="calcO()" class="calc-input" placeholder="Volt">
                I: <input type="number" id="i" oninput="calcO()" class="calc-input" placeholder="Ampere">
                R: <input type="number" id="r" oninput="calcO()" class="calc-input" placeholder="Ohm">
            </div>
            <div class="card">
                <h3>Cable Sizing</h3>
                Load Current (A): <input type="number" id="ampIn" oninput="cableSize()" class="calc-input">
                <div id="cableRes" class="res-box">Recommended Size: -- mm¬≤</div>
            </div>
        </div>

        <div id="p3" class="page">
            <div class="card">
                <h3>Construction Estimator</h3>
                Area (m¬≤): <input type="number" id="area" oninput="calcConst()" class="calc-input">
                Depth (m): <input type="number" id="depth" oninput="calcConst()" class="calc-input">
                <div id="constRes" class="res-box">Volume: 0 m¬≥ | Cement: 0 Bags</div>
            </div>
        </div>

        <div id="p4" class="page">
            <div class="card">
                <h3>üìü Multimeter Records</h3>
                Volt: <input type="number" id="mv" class="calc-input">
                Amp: <input type="number" id="mi" class="calc-input">
                Ohm: <input type="number" id="mr" class="calc-input">
                <button onclick="logToNotebook()" style="width:100%; padding:15px; background:var(--primary); color:white; border:none; border-radius:12px; font-weight:bold; margin-top:10px;">Push to Notebook</button>
            </div>
        </div>
    </div>
    
    <button class="save-btn" onclick="saveData()">üíæ SAVE TO CLOUD</button>
</div>

<script>
    // 1. FIREBASE CONFIG - Kun baay'ee murteessaa dha!
    // Firebase Console keessaa API Key kee as galchi
    const firebaseConfig = {
        apiKey: "AIzaSy...", 
        authDomain: "project-id.firebaseapp.com",
        databaseURL: "https://project-id-default-rtdb.firebaseio.com", // Database URL kee as galchi
        projectId: "project-id",
        storageBucket: "project-id.appspot.com",
        messagingSenderId: "...",
        appId: "..."
    };

    // Firebase Initialize gochuu
    if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
    }
    const db = firebase.database();

    let activeFolder = "Mechatronics";

    // 2. SAVE FUNCTION - Isni kun ragaa kee hunda walitti qaba
    function saveData() {
        const content = document.getElementById('nb-area').innerHTML;
        
        // Mallattoo loading agarsiisuuf
        const saveBtn = document.querySelector('.save-btn');
        const originalText = saveBtn.innerText;
        saveBtn.innerText = "Saving... ‚è≥";
        saveBtn.style.background = "#fbbf24";

        // Gara Firebase-itti erguu (Folder folderiin kuusa)
        db.ref('ams_v6/' + activeFolder).set(content)
        .then(() => {
            saveBtn.innerText = "Saved ‚úÖ";
            saveBtn.style.background = "#10b981";
            setTimeout(() => {
                saveBtn.innerText = originalText;
                saveBtn.style.background = "#10b981";
            }, 2000);
        })
        .catch((error) => {
            alert("Ragaa kuusuun hin danda'amne: " + error.message);
            saveBtn.innerText = "Error ‚ùå";
            saveBtn.style.background = "#ef4444";
        });
    }

    // 3. LOAD FUNCTION - Yeroo folder jijjiirtu ragaa fida
    function loadData(folder) {
        db.ref('ams_v6/' + folder).once('value', (snapshot) => {
            if (snapshot.exists()) {
                document.getElementById('nb-area').innerHTML = snapshot.val();
            } else {
                document.getElementById('nb-area').innerHTML = `<h3>${folder} Notebook</h3><hr><p>Barreeffama haaraa asitti jalqabi...</p>`;
            }
        });
    }

    // Login logic
    function checkLogin() {
        const e = document.getElementById('email').value;
        const p = document.getElementById('password').value;
        if(e === "Abdurhamanmohammeda@gmail.com" && p === "Abdu@1234") {
            document.getElementById('login-overlay').style.display = 'none';
            document.getElementById('app-content').style.display = 'flex';
            sessionStorage.setItem("ams_full_auth", "true");
            loadData(activeFolder);
        } else {
            document.getElementById('error').innerText = "Email ykn Password dogoggora!";
        }
    }

    // Folder switch logic
    function switchFolder(folder, btnId) {
        saveData(); // switch gochuun dura isa jiru save godha
        activeFolder = folder;
        document.querySelectorAll('.f-tab').forEach(t => t.classList.remove('active'));
        document.getElementById(btnId).classList.add('active');
        document.getElementById('folder-title').innerText = folder + " Notebook";
        loadData(folder);
    }

    window.onload = () => {
        if(sessionStorage.getItem("ams_full_auth") === "true") {
            document.getElementById('login-overlay').style.display = 'none';
            document.getElementById('app-content').style.display = 'flex';
            loadData(activeFolder);
        }
    };
</script>

</body>
</html>

